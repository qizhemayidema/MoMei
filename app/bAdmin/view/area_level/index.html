{include file="common/source"}
<div class="col-sm-12">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <div class="example">
                <div class="ibox-title">
                    <h5>
                        {if condition="$pidResult[0]['level'] eq 3"}
                        <button type="button" onclick="window.location.href='{:url('index',['pid'=>$threePid])}'"
                                class="btn btn-w-m btn-primary">返回上一级
                        </button>
                        {elseif condition="$pidResult[0]['level'] eq 2"}
                        <button type="button" onclick="window.location.href='{:url('index')}'"
                                class="btn btn-w-m btn-primary">返回上一级
                        </button>
                        {/if}
                    </h5>
                </div>
                <table class="table table-bordered table-hover text-center" >
                    <thead>
                    <tr class="text-center">
                        <th style="text-align: center;">地区</th>
                        <th style="text-align: center;">级别</th>
                        <th style="text-align: center;">热门</th>
                        <th style="text-align: center;">操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    {foreach $pidResult as $key => $value}
                    <tr onclick="oneClick({$value.id});">
                        <td style="text-align: left;">{$value.name}</td>
                        <td>{$value.level_value}</td>
                        <td>{if $value.is_hot}是{else}否{/if}</td>
                        <td>
                            {if condition="$value.level neq 3"}
                            <button onclick="window.location.href='{:url('index',['pid'=>$value.id])}'" class="btn btn-info" type="button"><i class="fa fa-paste"></i> 查看下级</button>
                            {/if}
                            <button onclick="window.location.href='{:url('edit',['city_id'=>$value.id])}'" class="btn btn-info" type="button"><i class="fa fa-paste"></i> 编辑</button>
                        </td>
                    </tr>
                    {/foreach}
                    </tbody>
                </table>
            </div>

        </div>
    </div>
</div>
<script>
    function oneClick(article_id) {
        $.ajax({
            url: "{:url('index')}",
            type: 'post',
            dataType: 'json',
            data: {
                pid: article_id,
            },
            success: function (result) {
                if (result.code == 1) {
                    var fill_data = "<div>";
                    for (i = 0;i<result.data.length;i++){
                        var name = result.data[i]['name'];
                        var id = result.data[i]['id'];
                        var val = result.data[i]['lavel_value'];
                        if(result.data[i]['is_hot']){
                            var hot = '是';
                        }else {
                            var hot = '否';
                        }
                        fill_data+="<tr onclick='twoClick("+id+")'><td>--"+name+"</td><td style='text-align: center'>"+val+"</td><td style='text-align: center'>"+hot+"</td>" +
                            "<button onclick=\"window.location.href='{:url('edit',['rule_id'=>1])}'\" class=\"btn btn-info\" type=\"button\"><i class=\"fa fa-paste\"></i> 编辑</button>";
                    }
                    console.log(fill_data);
                } else {

                }

            }
        })
    }
</script>